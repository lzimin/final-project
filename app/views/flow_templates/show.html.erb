<div class="row mb-3">
  <div class="col-md-8 offset-md-2">
    <h1>
       <a href="/campaigns/<%= @flow.campaign_id %>">
        <%= @flow.campaign.campaign_title %>
       </a>
      , Flow #<%= @flow.flow_version %>
    </h1>

    <div class="row mb-3">
      <div class="col">
        <a href="/flows" class="btn btn-block btn-outline-primary">
          Go back
        </a>
      </div>

      <div class="col">
        <a href="/flows/<%= @flow.id %>/edit" class="btn btn-block btn-outline-primary">
          Edit flow
        </a>
      </div>
    </div>

    <div class="col-width: 100%">
      <dd>
        <img src="<%= @flow.flow_image %>" class="img-fluid">
      </dd>
    </div>

    <dl>
      <dd>
          <div class="col-4">
            <form action="/create_flow_approval" method="post">
              <input type="hidden" id="flow_id" name="flow_id" value="<%= @flow.id %>">
              <input type="hidden" id="user_id" name="user_id" value="<%= current_user.id %>">
              
              <button type="submit" class="btn btn-primary btn-lg">
                Approve Flow
              </button>
            </form>
          </div>        
      </dd>
      
      <dt>
        Created by
      </dt>
      <dd>
        <a href="/users/<%= @flow.creator_id %>">
          <%= @flow.creator.first_name %>, <%= @flow.creator.last_name %>
        </a>
      </dd>

      <dt>
        Created at
      </dt>
      <dd>
        <%= time_ago_in_words(@flow.created_at) %> ago
      </dd>

      <dt>
        Updated at
      </dt>
      <dd>
        <%= time_ago_in_words(@flow.updated_at) %> ago

      </dd>
    </dl>






          <div>
            <% if FlowApproval.find_by(:flow_id => @flow.id).nil? %>
              <a> Flow not approved yet</a>
            <% else %>  
              <% FlowApproval.where(:flow_id => @flow.id).each do |approval| %>
                Approved by
                <a href="/users/<%= approval.user_id %>">
                  <%= User.find_by(:id => approval.user_id).first_name %>
                  <%= User.find_by(:id => approval.user_id).last_name %>                  
                </a>

              <% end %>
            <% end %>  
          </div>  
    
          <div>
            <% if FlowComment.find_by(:flow_id => @flow.id).nil? %>
              <div>
                No comments yet
              </div>
  
            <% else %>
              <% FlowComment.where(:flow_id => @flow.id).each do |comment| %>
                <div>
                  <ul>

                    <a href="/users/<%=comment.user_id%>"><%= comment.user.first_name %> <%= comment.user.last_name %></a>
                    <%= time_ago_in_words(comment.created_at) %> ago
                    <div>
                      <%= comment.body %>                      
                    </div>

                  </ul>
   
                </div>
              <% end %>
            <% end %>  
          </div>
          
          <form action="/create_flow_comment" method="post" class="pt-2">
            <input name="authenticity_token" type="hidden" value="<%= current_user.authenticatable_salt %>">
    
            <input type="hidden" name="flow_id" value="<%= @flow.id %>">
    
            <input type="hidden" name="user_id" value="<%= current_user.id %>">
    
            <!-- Label and input for body -->
            <div class="form-group">
              <label for="body" class="sr-only">
                Body
              </label>
    
              <div class="input-group">
                <input type="text" id="body" name="body" class="form-control" placeholder="Add a comment..." required="">
    
                <span class="input-group-append">
                  <button class="btn btn-primary" type="submit">
                    <i class="far fa-comment"></i>
    
                    Add Comment
                  </button>
                </span>
              </div>
            </div>
          </form>    
    
    
    
    <div class="row mb-3">
      <div class="col">
        <a href="/delete_flow/<%= @flow.id %>" class="btn btn-block btn-danger">
          Delete flow
        </a>
      </div>
    </div>
    
  </div>
</div>

